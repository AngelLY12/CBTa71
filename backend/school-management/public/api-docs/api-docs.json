{
    "openapi": "3.0.0",
    "info": {
        "title": "School Management API",
        "description": "Documentación de la API para el sistema de gestión escolar",
        "contact": {
            "name": "Equipo de desarrollo CBTa71",
            "email": "soporte@cbta71.edu.mx"
        },
        "license": {
            "name": "MIT",
            "url": "https://opensource.org/licenses/MIT"
        },
        "version": "1.0.0"
    },
    "servers": [
        {
            "url": "http://localhost:9000/api",
            "description": "Servidor local"
        },
        {
            "url": "https://nginx-production-728f.up.railway.app/api",
            "description": "Servidor de producción"
        }
    ],
    "paths": {
        "/api/v1/admin-actions/attach-student": {
            "post": {
                "tags": [
                    "Admin"
                ],
                "summary": "Asociar detalles de estudiante a un usuario existente",
                "description": "Permite asignar información académica a un usuario, incluyendo carrera, semestre, grupo y taller.",
                "operationId": "24648f2e8ed85f8ba380c575d16615ec",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "user_id",
                                    "career_id",
                                    "n_control",
                                    "semestre",
                                    "group",
                                    "workshop"
                                ],
                                "properties": {
                                    "user_id": {
                                        "type": "integer",
                                        "example": 12
                                    },
                                    "career_id": {
                                        "type": "integer",
                                        "example": 3
                                    },
                                    "n_control": {
                                        "type": "string",
                                        "example": "2020456789"
                                    },
                                    "semestre": {
                                        "type": "integer",
                                        "example": 5
                                    },
                                    "group": {
                                        "type": "string",
                                        "example": "B"
                                    },
                                    "workshop": {
                                        "type": "string",
                                        "example": "Taller de Robótica"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Usuario asociado correctamente a un detalle de estudiante.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 12
                                                        },
                                                        "name": {
                                                            "type": "string",
                                                            "example": "Carlos Pérez"
                                                        },
                                                        "career": {
                                                            "type": "string",
                                                            "example": "Ingeniería en Sistemas"
                                                        },
                                                        "n_control": {
                                                            "type": "string",
                                                            "example": "2020456789"
                                                        },
                                                        "semestre": {
                                                            "type": "integer",
                                                            "example": 5
                                                        },
                                                        "group": {
                                                            "type": "string",
                                                            "example": "B"
                                                        },
                                                        "workshop": {
                                                            "type": "string",
                                                            "example": "Taller de Robótica"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Se asociarón correctamente los datos al estudiante."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error en la validación de datos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Error en la validación de datos."
                                        },
                                        "errors": {
                                            "properties": {
                                                "user_id": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "string",
                                                        "example": "El campo user_id es obligatorio."
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/admin-actions/import": {
            "post": {
                "tags": [
                    "Admin"
                ],
                "summary": "Importar usuarios desde un archivo Excel",
                "description": "Permite subir un archivo Excel con los datos de los usuarios para registrarlos masivamente.",
                "operationId": "681466b5379337f44a10ff79de6c51fe",
                "requestBody": {
                    "required": true,
                    "content": {
                        "multipart/form-data": {
                            "schema": {
                                "required": [
                                    "file"
                                ],
                                "properties": {
                                    "file": {
                                        "description": "Archivo Excel (.xlsx) con la información de los usuarios a importar",
                                        "type": "string",
                                        "format": "binary"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Usuarios importados correctamente.",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Usuarios importados correctamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/admin-actions/update-permissions": {
            "post": {
                "tags": [
                    "Admin"
                ],
                "summary": "Actualizar permisos a múltiples usuarios",
                "description": "Permite al administrador agregar o eliminar permisos a varios usuarios al mismo tiempo.\n     *     Se puede especificar una lista de correos electrónicos y los permisos que se añadirán o eliminarán.",
                "operationId": "updateManyUserPermissions",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "emails"
                                ],
                                "properties": {
                                    "emails": {
                                        "description": "Lista de correos electrónicos de los usuarios a los que se aplicarán los cambios",
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "juan@escuela.edu"
                                        }
                                    },
                                    "permissionsToAdd": {
                                        "description": "Permisos que se agregarán a los usuarios",
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "view payments"
                                        }
                                    },
                                    "permissionsToRemove": {
                                        "description": "Permisos que se eliminarán de los usuarios",
                                        "type": "array",
                                        "items": {
                                            "type": "string",
                                            "example": "delete card"
                                        }
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Permisos actualizados correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "Permisos actualizados correctamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error de validación en los datos enviados",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "message": {
                                            "type": "string",
                                            "example": "El campo emails es obligatorio."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "No autorizado: el usuario autenticado no tiene permiso para ejecutar esta acción"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/register": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Registro de nuevo usuario",
                "description": "Crea un nuevo usuario en el sistema con los datos proporcionados.",
                "operationId": "dafb630535d807244a6cb5ee41678a3f",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "name",
                                    "last_name",
                                    "email",
                                    "password",
                                    "phone_number",
                                    "curp",
                                    "status"
                                ],
                                "properties": {
                                    "name": {
                                        "type": "string",
                                        "example": "Carlos"
                                    },
                                    "last_name": {
                                        "type": "string",
                                        "example": "Calderon Espinoza"
                                    },
                                    "email": {
                                        "type": "string",
                                        "format": "email",
                                        "example": "example@gmail.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "123"
                                    },
                                    "phone_number": {
                                        "type": "string",
                                        "example": "7357891145"
                                    },
                                    "birthdate": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2000-10-22"
                                    },
                                    "gender": {
                                        "type": "string",
                                        "example": "Hombre"
                                    },
                                    "curp": {
                                        "type": "string",
                                        "example": "EXMP090304JMSPXNU7"
                                    },
                                    "address": {
                                        "properties": {
                                            "street": {
                                                "type": "string",
                                                "example": "Calle Reforma 123"
                                            },
                                            "city": {
                                                "type": "string",
                                                "example": "Cuautla"
                                            },
                                            "state": {
                                                "type": "string",
                                                "example": "Morelos"
                                            },
                                            "zip": {
                                                "type": "string",
                                                "example": "62740"
                                            }
                                        },
                                        "type": "object"
                                    },
                                    "blood_type": {
                                        "type": "string",
                                        "example": "O+"
                                    },
                                    "registration_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-11-02"
                                    },
                                    "status": {
                                        "type": "string",
                                        "example": "activo"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Usuario creado con éxito",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "user": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 1
                                                        },
                                                        "email": {
                                                            "type": "string",
                                                            "example": "example@gmail.com"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "El usuario ha sido creado con éxito."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error en la validación de datos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Error en la validación de datos."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/login": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Inicio de sesión de usuario",
                "description": "Autentica un usuario con su correo electrónico y contraseña, y devuelve el token y refresh token.",
                "operationId": "2bd778ac594b753b1466d635caf32e28",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "email",
                                    "password"
                                ],
                                "properties": {
                                    "email": {
                                        "type": "string",
                                        "example": "example@gmail.com"
                                    },
                                    "password": {
                                        "type": "string",
                                        "example": "123"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Inicio de sesión exitoso",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "user_tokens": {
                                                    "properties": {
                                                        "access_token": {
                                                            "type": "string",
                                                            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                                                        },
                                                        "refresh_token": {
                                                            "type": "string",
                                                            "example": "def50200fcdcb15b13e.."
                                                        },
                                                        "token_type": {
                                                            "type": "string",
                                                            "example": "Bearer"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Inicio de sesión exitoso."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error en la validación de datos",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Error en la validación de datos."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "Credenciales incorrectas"
                    }
                }
            }
        },
        "/api/v1/refresh-token": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Refrescar token de acceso",
                "description": "Recibe un token de actualización (refresh token) y devuelve un nuevo token de acceso válido. Tambien rota el refresh token",
                "operationId": "ab3e1bb07b8ea9c9833f844ac34aaa4b",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "refresh_token"
                                ],
                                "properties": {
                                    "refresh_token": {
                                        "type": "string",
                                        "example": "def50200fcdcb15b13e..."
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Token renovado con éxito",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "user_tokens": {
                                                    "properties": {
                                                        "access_token": {
                                                            "type": "string",
                                                            "example": "eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9..."
                                                        },
                                                        "refresh_token": {
                                                            "type": "string",
                                                            "example": "def50200fcdcb15b13e..."
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "token_type": {
                                            "type": "string",
                                            "example": "Bearer"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "403": {
                        "description": "Refresh token invalido",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": false
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Refresh token inválido."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                }
            }
        },
        "/api/v1/logout": {
            "post": {
                "tags": [
                    "Auth"
                ],
                "summary": "Cerrar sesión",
                "description": "Cierra la sesión del usuario y revoca el refresh token proporcionado.",
                "operationId": "b34a466f3bcfb011074f4b2a8766152e",
                "parameters": [
                    {
                        "name": "x-refresh-token",
                        "in": "header",
                        "description": "Refresh token asociado a la sesión",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "example": "def50200fcdcb15b13e..."
                        }
                    }
                ],
                "responses": {
                    "204": {
                        "description": "Sesión cerrada exitosamente (sin contenido)"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts": {
            "get": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Listar conceptos de pago",
                "description": "Obtiene una lista paginada de conceptos de pago, con filtros opcionales por estado y control de caché.",
                "operationId": "f9d62ceeda29d557b295b481705f8256",
                "parameters": [
                    {
                        "name": "status",
                        "in": "query",
                        "description": "Filtra por estado (ej. 'activo', 'todos', etc)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "activo"
                        }
                    },
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Cantidad de registros por página",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página a obtener",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Si es true, fuerza actualización de caché",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Listado de conceptos de pago obtenido exitosamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "concepts": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "concept_name": {
                                                                "type": "string",
                                                                "example": "Pago de inscripción"
                                                            },
                                                            "amount": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "example": 1500
                                                            },
                                                            "status": {
                                                                "type": "string",
                                                                "example": "activo"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Crear un nuevo concepto de pago",
                "description": "Crea un nuevo concepto de pago y lo asocia con las entidades correspondientes (carreras, semestres, estudiantes).",
                "operationId": "743f0533fc17f5c5ab407a7991420bb4",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "concept_name",
                                    "status",
                                    "start_date",
                                    "amount",
                                    "is_global",
                                    "applies_to"
                                ],
                                "properties": {
                                    "concept_name": {
                                        "type": "string",
                                        "example": "Pago de reinscripción"
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Pago correspondiente al semestre agosto-diciembre."
                                    },
                                    "status": {
                                        "type": "string",
                                        "example": "activo"
                                    },
                                    "start_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-08-01"
                                    },
                                    "end_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-09-01"
                                    },
                                    "amount": {
                                        "type": "number",
                                        "example": 1500
                                    },
                                    "is_global": {
                                        "type": "boolean",
                                        "example": true
                                    },
                                    "applies_to": {
                                        "type": "string",
                                        "example": "todos"
                                    },
                                    "semestres": {
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 5
                                        }
                                    },
                                    "careers": {
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 3
                                        }
                                    },
                                    "students": {
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 12
                                        }
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Concepto de pago creado exitosamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "concept": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 5
                                                        },
                                                        "concept_name": {
                                                            "type": "string",
                                                            "example": "Pago de reinscripción"
                                                        },
                                                        "status": {
                                                            "type": "string",
                                                            "example": "activo"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Concepto de pago creado con éxito."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error en la validación de datos"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    },
                    "404": {
                        "description": "Recurso no encontrado"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts/{id}": {
            "put": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Actualizar un concepto de pago",
                "description": "Actualiza los datos de un concepto de pago existente. Todos los campos son opcionales (usar 'sometimes'), excepto el id en la ruta.",
                "operationId": "5255c45ecbf80e25ad1524e85dbb6094",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "description": "ID del concepto de pago",
                        "required": true,
                        "schema": {
                            "type": "integer",
                            "example": 5
                        }
                    }
                ],
                "requestBody": {
                    "required": false,
                    "content": {
                        "application/json": {
                            "schema": {
                                "properties": {
                                    "concept_name": {
                                        "type": "string",
                                        "example": "Pago actualizado"
                                    },
                                    "description": {
                                        "type": "string",
                                        "example": "Descripción actualizada del concepto"
                                    },
                                    "status": {
                                        "type": "string",
                                        "example": "activo"
                                    },
                                    "start_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-08-01"
                                    },
                                    "end_date": {
                                        "type": "string",
                                        "format": "date",
                                        "example": "2025-09-01"
                                    },
                                    "amount": {
                                        "type": "number",
                                        "format": "float",
                                        "example": 1200.5
                                    },
                                    "is_global": {
                                        "type": "boolean",
                                        "example": false
                                    },
                                    "applies_to": {
                                        "type": "string",
                                        "example": "carrera"
                                    },
                                    "semestres": {
                                        "description": "Array de ids/valores de semestres (opcional)",
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 5
                                        }
                                    },
                                    "careers": {
                                        "description": "Array de ids de carreras (opcional)",
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 3
                                        }
                                    },
                                    "students": {
                                        "description": "Array de ids de estudiantes (opcional)",
                                        "type": "array",
                                        "items": {
                                            "type": "integer",
                                            "example": 12
                                        }
                                    },
                                    "replaceRelations": {
                                        "description": "Si true, reemplaza relaciones en vez de anexar",
                                        "type": "boolean",
                                        "example": true
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Concepto actualizado correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "concept": {
                                                    "properties": {
                                                        "id": {
                                                            "type": "integer",
                                                            "example": 5
                                                        },
                                                        "concept_name": {
                                                            "type": "string",
                                                            "example": "Pago actualizado"
                                                        },
                                                        "amount": {
                                                            "type": "number",
                                                            "example": 1200.5
                                                        },
                                                        "status": {
                                                            "type": "string",
                                                            "example": "activo"
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Concepto de pago actualizado correctamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error en la validación de datos"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    },
                    "404": {
                        "description": "Recurso no encontrado"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "delete": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Eliminar concepto de pago (físicamente)",
                "operationId": "a1ce3785ce0caf528b2a88675bdad7d1",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Concepto de pago eliminado correctamente"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts/{id}/finalize": {
            "post": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Finalizar concepto de pago",
                "operationId": "8a9c1d973d9719799f25e9f3123c4773",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Concepto de pago finalizado correctamente"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts/{id}/disable": {
            "post": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Deshabilitar un concepto de pago",
                "operationId": "6e47ae9f127401a1e2f21ed7288a2624",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Concepto de pago deshabilitado correctamente"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts/{id}/activate": {
            "post": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Habilitar un concepto de pago",
                "operationId": "b3114aa4c8d7035e4022502021b2623c",
                "parameters": [
                    {
                        "name": "id",
                        "in": "path",
                        "required": true,
                        "schema": {
                            "type": "integer"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Concepto de pago habilitado correctamente"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/concepts/{id}/logical": {
            "delete": {
                "tags": [
                    "Payment Concepts"
                ],
                "summary": "Eliminar concepto de pago (lógicamente)",
                "operationId": "7c483a4909f142379af6a8c31921454d",
                "responses": {
                    "200": {
                        "description": "Concepto eliminado lógicamente correctamente"
                    },
                    "409": {
                        "description": "Conflicto en los datos"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/data": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener estadísticas generales del dashboard",
                "description": "Devuelve estadísticas generales como totales, montos y datos de rendimiento. Se puede filtrar por año actual y forzar actualización del caché.",
                "operationId": "a23679bacc898b8e8dd023f629a8ab44",
                "parameters": [
                    {
                        "name": "only_this_year",
                        "in": "query",
                        "description": "Si es true, filtra los datos al año actual",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": true
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Si es true, fuerza la actualización del caché",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Datos del dashboard obtenidos correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "statistics": {
                                                    "properties": {
                                                        "students": {
                                                            "type": "integer",
                                                            "example": 120
                                                        },
                                                        "pending": {
                                                            "properties": {
                                                                "total_amount": {
                                                                    "type": "integer",
                                                                    "example": 2500
                                                                },
                                                                "total_count": {
                                                                    "type": "integer",
                                                                    "example": 2
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "earnings": {
                                                            "type": "integer",
                                                            "example": 1005
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/pending-payments": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener cantidad y monto total de pagos pendientes",
                "operationId": "626fb57370a4017884b788029222768e",
                "parameters": [
                    {
                        "name": "only_this_year",
                        "in": "query",
                        "description": "Filtrar solo por el año actual",
                        "schema": {
                            "type": "boolean",
                            "example": true
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché",
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Totales de pagos pendientes obtenidos correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "total_pending": {
                                                    "type": "object",
                                                    "example": {
                                                        "total_count": 12,
                                                        "total_amount": 5600.75
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/students": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener el número total de estudiantes",
                "operationId": "0fed8bff97e80e0820aef055b4e9677c",
                "parameters": [
                    {
                        "name": "only_this_year",
                        "in": "query",
                        "description": "Filtrar solo por el año actual",
                        "schema": {
                            "type": "boolean",
                            "example": true
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché",
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Número total de estudiantes obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "total_students": {
                                                    "type": "integer",
                                                    "example": 1500
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/payments-made": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener monto total de pagos realizados",
                "operationId": "a634e31096c9624601bd7b741c1d9004",
                "parameters": [
                    {
                        "name": "only_this_year",
                        "in": "query",
                        "description": "Filtrar solo por el año actual",
                        "schema": {
                            "type": "boolean",
                            "example": true
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché",
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Monto total de pagos realizados obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "total_earning": {
                                                    "type": "number",
                                                    "example": 325000
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/concepts": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener todos los conceptos de pago",
                "operationId": "95eef3a23564cc672ef466a0177e5c0a",
                "parameters": [
                    {
                        "name": "only_this_year",
                        "in": "query",
                        "schema": {
                            "type": "boolean",
                            "example": true
                        }
                    },
                    {
                        "name": "perPage",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "example": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista de conceptos obtenida correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "concepts": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "example": {
                                                            "id": 1,
                                                            "concept_name": "Inscripción",
                                                            "amount": 1500,
                                                            "status": "activo"
                                                        }
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard-staff/refresh": {
            "post": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Limpiar el caché del dashboard",
                "description": "Forza el borrado del caché en todos los datos del dashboard.",
                "operationId": "1986cc5e794aa644e1efe3001363cb2c",
                "responses": {
                    "200": {
                        "description": "Caché limpiado correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Dashboard cache limpiado con éxito"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/debts": {
            "get": {
                "tags": [
                    "Debts"
                ],
                "summary": "Listar pagos pendientes",
                "description": "Obtiene la lista de todos los pagos pendientes registrados. Permite buscar, paginar y forzar la actualización del caché.",
                "operationId": "773aaeb3249ad9281a5db34d0fc35451",
                "parameters": [
                    {
                        "name": "search",
                        "in": "query",
                        "description": "Texto de búsqueda para filtrar por nombre o control del estudiante.",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "Angel Lopez"
                        }
                    },
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Número de elementos por página",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página actual",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Si es true, fuerza la actualización del caché",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista de pagos pendientes obtenida correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "pending_payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "example": {
                                                            "id": 1,
                                                            "user_name": "Angel López",
                                                            "concept_name": "Inscripción",
                                                            "amount": 1500
                                                        }
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": null,
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/debts/validate": {
            "post": {
                "tags": [
                    "Debts"
                ],
                "summary": "Validar un pago de Stripe",
                "description": "Valida un pago realizado en Stripe mediante el `payment_intent_id` y la búsqueda del estudiante.",
                "operationId": "17c23f19ae55d836b49187e1a515784a",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "search",
                                    "payment_intent_id"
                                ],
                                "properties": {
                                    "search": {
                                        "type": "string",
                                        "example": "LOYA030504HMSPXNA8"
                                    },
                                    "payment_intent_id": {
                                        "type": "string",
                                        "example": "pi_3Q3u9YBvLxeAQs9T1zUzr3YH"
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "200": {
                        "description": "Pago validado correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "validated_payment": {
                                                    "type": "object",
                                                    "example": {
                                                        "id": 10,
                                                        "student": "Angel López",
                                                        "amount": 1500,
                                                        "status": "pagado"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Pago validado correctamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error de validación en los datos enviados"
                    },
                    "409": {
                        "description": "Recurso no encontrado"
                    },
                    "500": {
                        "description": "Error de stripe"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/debts/stripe-payments": {
            "get": {
                "tags": [
                    "Debts"
                ],
                "summary": "Obtener pagos desde Stripe",
                "description": "Obtiene todos los pagos registrados en Stripe asociados a un estudiante específico. Se puede filtrar por año y forzar actualización del caché.",
                "operationId": "2c87245d593a5a08c0a372b1f2a37040",
                "parameters": [
                    {
                        "name": "search",
                        "in": "query",
                        "description": "CURP, nombre o email del estudiante",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "example": "LOYA030504HMSPXNA8"
                        }
                    },
                    {
                        "name": "year",
                        "in": "query",
                        "description": "Año específico de los pagos",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 2025
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Si es true, fuerza la actualización del caché",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Pagos obtenidos correctamente desde Stripe",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "type": "object",
                                                        "example": {
                                                            "id": "ci_3Q...",
                                                            "payment_intent_id": "pi_3Q...",
                                                            "concept_name": "Inscripción",
                                                            "amount_total": 2000,
                                                            "created": "2025-11-02T12:34:56Z"
                                                        }
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Pagos obtenidos correctamente."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error de validación en los parámetros enviados"
                    },
                    "409": {
                        "description": "Recurso no encontrado"
                    },
                    "500": {
                        "description": "Error de stripe"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/payments": {
            "get": {
                "tags": [
                    "Payments"
                ],
                "summary": "Obtener lista de pagos",
                "description": "Devuelve una lista paginada de pagos registrados, con opción de búsqueda y refresco de caché.",
                "operationId": "getPayments",
                "parameters": [
                    {
                        "name": "search",
                        "in": "query",
                        "description": "Filtro de búsqueda opcional (por nombre, referencia u otros campos)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "Juan Pérez"
                        }
                    },
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Número de resultados por página (por defecto 15)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 10
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página actual (por defecto 1)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista de pagos obtenida exitosamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "date": {
                                                                "type": "string",
                                                                "example": "2025-07-12"
                                                            },
                                                            "concept": {
                                                                "type": "string",
                                                                "example": "Inscripción"
                                                            },
                                                            "amount": {
                                                                "type": "integer",
                                                                "example": 2500
                                                            },
                                                            "method": {
                                                                "type": "string",
                                                                "example": "card"
                                                            },
                                                            "fullName": {
                                                                "type": "string",
                                                                "example": "Carlo Magno"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay pagos registrados.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/students": {
            "get": {
                "tags": [
                    "Students"
                ],
                "summary": "Obtener lista de estudiantes",
                "description": "Devuelve una lista paginada de estudiantes registrados. Permite buscar, filtrar y forzar la actualización del caché.",
                "operationId": "getStudents",
                "parameters": [
                    {
                        "name": "search",
                        "in": "query",
                        "description": "Filtro de búsqueda opcional (por nombre, matrícula, correo, etc.)",
                        "required": false,
                        "schema": {
                            "type": "string",
                            "example": "María López"
                        }
                    },
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Cantidad de resultados por página (por defecto 15)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 10
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página (por defecto 1)",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista de estudiantes obtenida exitosamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "students": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "user_id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "fullName": {
                                                                "type": "string",
                                                                "example": "María López"
                                                            },
                                                            "semestre": {
                                                                "type": "integer",
                                                                "example": 9
                                                            },
                                                            "career_name": {
                                                                "type": "string",
                                                                "example": "Matematicas"
                                                            },
                                                            "num_pending": {
                                                                "type": "integer",
                                                                "example": 2
                                                            },
                                                            "total_amount_pending": {
                                                                "type": "integer",
                                                                "example": 2500
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay estudiantes registrados.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/cards": {
            "get": {
                "tags": [
                    "Cards"
                ],
                "summary": "Listar métodos de pago del usuario autenticado",
                "description": "Obtiene la lista de tarjetas o métodos de pago asociados al usuario autenticado. Permite forzar actualización del caché.",
                "operationId": "getUserCards",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Lista de métodos de pago obtenida correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "cards": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "string",
                                                                "example": "pm_1P7E89AjcPzVqRkV"
                                                            },
                                                            "brand": {
                                                                "type": "string",
                                                                "example": "visa"
                                                            },
                                                            "last4": {
                                                                "type": "string",
                                                                "example": "4242"
                                                            },
                                                            "exp_month": {
                                                                "type": "integer",
                                                                "example": 12
                                                            },
                                                            "exp_year": {
                                                                "type": "integer",
                                                                "example": 2030
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No se encontraron métodos de pago.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "No autorizado - Token inválido o ausente"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Cards"
                ],
                "summary": "Registrar un nuevo método de pago",
                "description": "Crea una sesión de Stripe Checkout para registrar una nueva tarjeta del usuario autenticado.",
                "operationId": "addUserCard",
                "responses": {
                    "201": {
                        "description": "Sesión de registro de método de pago creada exitosamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "url_checkout": {
                                                    "type": "string",
                                                    "example": "https://checkout.stripe.com/pay/cs_test_a1b2c3..."
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/cards/{paymentMethodId}": {
            "delete": {
                "tags": [
                    "Cards"
                ],
                "summary": "Eliminar un método de pago",
                "description": "Elimina un método de pago específico asociado al usuario autenticado.",
                "operationId": "deleteUserCard",
                "parameters": [
                    {
                        "name": "paymentMethodId",
                        "in": "path",
                        "description": "ID del método de pago a eliminar (por ejemplo, 'pm_1P7E89AjcPzVqRkV')",
                        "required": true,
                        "schema": {
                            "type": "string",
                            "example": "pm_1P7E89AjcPzVqRkV"
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Método de pago eliminado correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Método de pago eliminado correctamente"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "404": {
                        "description": "Método de pago no encontrado"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener estadísticas generales del dashboard del usuario",
                "description": "Devuelve información resumida de los conceptos, pagos y deudas del usuario autenticado.",
                "operationId": "getDashboardData",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Datos del dashboard obtenidos correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "statistics": {
                                                    "properties": {
                                                        "completed": {
                                                            "type": "integer",
                                                            "example": 1200
                                                        },
                                                        "pending": {
                                                            "properties": {
                                                                "total_amount": {
                                                                    "type": "integer",
                                                                    "example": 2500
                                                                },
                                                                "total_count": {
                                                                    "type": "integer",
                                                                    "example": 2
                                                                }
                                                            },
                                                            "type": "object"
                                                        },
                                                        "overdue": {
                                                            "type": "integer",
                                                            "example": 105
                                                        }
                                                    },
                                                    "type": "object"
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard/pending": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener total de pagos pendientes del usuario",
                "description": "Devuelve la cantidad y monto total de los pagos pendientes del usuario autenticado.",
                "operationId": "getPendingPayments",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Total de pagos pendientes obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "total_amount": {
                                                    "type": "integer",
                                                    "example": 1200
                                                },
                                                "total_count": {
                                                    "type": "integer",
                                                    "format": "float",
                                                    "example": 2
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard/paid": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener total de pagos realizados por el usuario",
                "description": "Devuelve el monto total de pagos completados por el usuario autenticado.",
                "operationId": "getPaidAmount",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Monto total de pagos realizados obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "paid": {
                                            "properties": {
                                                "total_paid": {
                                                    "type": "integer",
                                                    "example": 3500
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard/overdue": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener total de pagos vencidos del usuario",
                "description": "Devuelve el monto total de los pagos vencidos asociados al usuario autenticado.",
                "operationId": "getOverduePayments",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché (true o false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Monto total de pagos vencidos obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "overdue": {
                                            "properties": {
                                                "total_overdue": {
                                                    "type": "integer",
                                                    "example": 500
                                                }
                                            },
                                            "type": "object"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard/history": {
            "get": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Obtener historial de pagos del usuario",
                "description": "Devuelve una lista paginada con el historial de pagos realizados por el usuario autenticado.",
                "operationId": "getPaymentHistory",
                "parameters": [
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Número de registros por página",
                        "schema": {
                            "type": "integer",
                            "example": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página",
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización de caché",
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Historial de pagos obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "payment_history": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "concept": {
                                                                "type": "string",
                                                                "example": "Inscripción Enero-Junio"
                                                            },
                                                            "amount": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "example": 1500
                                                            },
                                                            "date": {
                                                                "type": "string",
                                                                "example": "2025-03-01T10:20:30Z"
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay pagos registrados en el historial",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/dashboard/refresh": {
            "post": {
                "tags": [
                    "Dashboard"
                ],
                "summary": "Limpiar caché del dashboard",
                "description": "Limpia el caché de datos almacenados en el dashboard (estadísticas, pagos, etc.)",
                "operationId": "refreshDashboardCache",
                "responses": {
                    "200": {
                        "description": "Caché del dashboard limpiado con éxito",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "Dashboard cache limpiado con éxito"
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/history": {
            "get": {
                "tags": [
                    "Payment History"
                ],
                "summary": "Obtener historial de pagos del usuario autenticado",
                "description": "Devuelve el historial de pagos del usuario logueado, con soporte para paginación y cacheo.",
                "operationId": "getUserPaymentHistory",
                "parameters": [
                    {
                        "name": "perPage",
                        "in": "query",
                        "description": "Cantidad de registros por página",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 15
                        }
                    },
                    {
                        "name": "page",
                        "in": "query",
                        "description": "Número de página",
                        "required": false,
                        "schema": {
                            "type": "integer",
                            "example": 1
                        }
                    },
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché (true/false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Historial de pagos obtenido correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "payment_history": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 1
                                                            },
                                                            "concept_name": {
                                                                "type": "string",
                                                                "example": "Inscripción"
                                                            },
                                                            "amount": {
                                                                "type": "number",
                                                                "format": "float",
                                                                "example": 500.75
                                                            },
                                                            "status": {
                                                                "type": "string",
                                                                "example": "completed"
                                                            },
                                                            "date": {
                                                                "type": "string",
                                                                "format": "date-time",
                                                                "example": "2025-10-31T14:30:00Z"
                                                            },
                                                            "reference": {
                                                                "type": "string",
                                                                "example": "pi_Hyg76..."
                                                            },
                                                            "url": {
                                                                "type": "string",
                                                                "example": "https://stripe..."
                                                            },
                                                            "payment_method_details": {
                                                                "type": "array",
                                                                "items": {
                                                                    "properties": {
                                                                        "type": {
                                                                            "type": "string",
                                                                            "example": "card"
                                                                        },
                                                                        "brand": {
                                                                            "type": "string",
                                                                            "example": "visa"
                                                                        },
                                                                        "last4": {
                                                                            "type": "string",
                                                                            "example": "4242"
                                                                        }
                                                                    },
                                                                    "type": "object"
                                                                }
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay historial de pagos para este usuario.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "No autorizado - Token inválido o ausente"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/pending-payments": {
            "get": {
                "tags": [
                    "Pending Payment"
                ],
                "summary": "Obtener pagos pendientes del usuario autenticado",
                "description": "Devuelve todos los conceptos pendientes de pago del usuario logueado.",
                "operationId": "getUserPendingPayments",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché (true/false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Pagos pendientes obtenidos correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "pending_payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 12
                                                            },
                                                            "concept_name": {
                                                                "type": "string",
                                                                "example": "Mensualidad Octubre"
                                                            },
                                                            "amount": {
                                                                "type": "integer",
                                                                "example": 550
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay pagos pendientes para el usuario.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            },
            "post": {
                "tags": [
                    "Pending Payment"
                ],
                "summary": "Generar intento de pago para un concepto pendiente",
                "description": "Crea un intento de pago en Stripe (u otro proveedor) para el concepto indicado.",
                "operationId": "createPaymentIntent",
                "requestBody": {
                    "required": true,
                    "content": {
                        "application/json": {
                            "schema": {
                                "required": [
                                    "concept_id"
                                ],
                                "properties": {
                                    "concept_id": {
                                        "description": "ID del concepto a pagar",
                                        "type": "integer",
                                        "example": 12
                                    }
                                },
                                "type": "object"
                            }
                        }
                    }
                },
                "responses": {
                    "201": {
                        "description": "Intento de pago generado correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "url_checkout": {
                                                    "type": "string",
                                                    "example": "https://checkout.stripe.com/pay/cs_test_..."
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "El intento de pago se generó con éxito."
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "422": {
                        "description": "Error de validación"
                    },
                    "404": {
                        "description": "Recurso no encontrado"
                    },
                    "403": {
                        "description": "No esta permitido"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        },
        "/api/v1/pending-payments/overdue": {
            "get": {
                "tags": [
                    "Pending Payment"
                ],
                "summary": "Obtener pagos vencidos del usuario autenticado",
                "description": "Devuelve los pagos que ya están vencidos para el usuario autenticado.",
                "operationId": "getUserOverduePayments",
                "parameters": [
                    {
                        "name": "forceRefresh",
                        "in": "query",
                        "description": "Forzar actualización del caché (true/false)",
                        "required": false,
                        "schema": {
                            "type": "boolean",
                            "example": false
                        }
                    }
                ],
                "responses": {
                    "200": {
                        "description": "Pagos vencidos obtenidos correctamente",
                        "content": {
                            "application/json": {
                                "schema": {
                                    "properties": {
                                        "success": {
                                            "type": "boolean",
                                            "example": true
                                        },
                                        "data": {
                                            "properties": {
                                                "overdue_payments": {
                                                    "type": "array",
                                                    "items": {
                                                        "properties": {
                                                            "id": {
                                                                "type": "integer",
                                                                "example": 5
                                                            },
                                                            "concept_name": {
                                                                "type": "string",
                                                                "example": "Mensualidad Septiembre"
                                                            },
                                                            "amount": {
                                                                "type": "integer",
                                                                "example": 600
                                                            }
                                                        },
                                                        "type": "object"
                                                    }
                                                }
                                            },
                                            "type": "object"
                                        },
                                        "message": {
                                            "type": "string",
                                            "example": "No hay pagos vencidos para el usuario.",
                                            "nullable": true
                                        }
                                    },
                                    "type": "object"
                                }
                            }
                        }
                    },
                    "401": {
                        "description": "No autorizado - Token inválido o ausente"
                    }
                },
                "security": [
                    {
                        "bearerAuth": []
                    }
                ]
            }
        }
    },
    "tags": [
        {
            "name": "Admin",
            "description": "Endpoints para gestión administrativa (asignación e importación de usuarios)"
        },
        {
            "name": "Auth",
            "description": "Endpoints de autenticación: renovación y cierre de sesión"
        },
        {
            "name": "Payment Concepts",
            "description": "Gestión de conceptos de pago en el sistema (creación, actualización, activación, eliminación, etc.)"
        },
        {
            "name": "Debts",
            "description": "Endpoints para la gestión y consulta de pagos pendinetes y validación de los mismos cuando haya un error de registro"
        },
        {
            "name": "Payments",
            "description": "Endpoints para la gestión y consulta de pagos registrados"
        },
        {
            "name": "Students",
            "description": "Endpoints para la gestión y consulta de estudiantes registrados"
        },
        {
            "name": "Cards",
            "description": "Gestión de métodos de pago (tarjetas) asociados a los usuarios"
        },
        {
            "name": "Dashboard",
            "description": "Endpoints relacionados con el panel de control del usuario (estadísticas, pagos y resumen financiero)"
        },
        {
            "name": "Payment History",
            "description": "Payment History"
        },
        {
            "name": "Pending Payment",
            "description": "Pending Payment"
        }
    ]
}