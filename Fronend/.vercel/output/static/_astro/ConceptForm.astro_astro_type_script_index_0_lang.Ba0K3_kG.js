import{c as i}from"./store.C87EM-IA.js";document.addEventListener("DOMContentLoaded",()=>{const b=document.getElementById("conceptForm"),c=document.getElementById("target-buttons"),u=document.getElementById("applyTo"),p=document.getElementById("semesterSelect"),m=document.getElementById("careerSelect"),o=document.getElementById("studentsContainer"),x=document.getElementById("addStudentBtn"),y=document.getElementById("addStudentBtnWrapper");function d(t=""){const n=document.createElement("div");n.className="flex items-center gap-2 mb-2",n.innerHTML=`
        <input
          type="text"
          name="students[]"
          class="flex-1 px-4 py-2 border rounded-lg focus:outline-none focus:ring-2 focus:ring-[#2e594d]"
          placeholder="Nombre o matrícula del alumno"
          value="${t}"
        />
        <button type="button" class="px-3 py-1 rounded-lg bg-red-200 text-red-800 font-semibold text-sm remove-student">
          -
        </button>
      `,o.appendChild(n)}function g(t){c.querySelectorAll("button").forEach(n=>{n.classList.remove("bg-green-100","text-green-800"),n.classList.add("bg-green-100","text-green-800"),n.dataset.target===t&&(n.classList.remove("bg-green-100","text-green-800"),n.classList.add("bg-[#2e594d]","text-white"))}),p.style.display="none",m.style.display="none",o.style.display="none",y.style.display="none",t==="semestre"?p.style.display="block":t==="carrera"?m.style.display="block":t==="alumnos"&&(o.style.display="block",y.style.display="block")}const a=u.value;g(a),a==="alumnos"&&window.Astro.props.concept?.students?(o.innerHTML="",window.Astro.props.concept.students.forEach(t=>{d(t)}),window.Astro.props.concept.students.length===0&&d()):a==="alumnos"&&d(),x.addEventListener("click",()=>{d()}),o.addEventListener("click",t=>{t.target.classList.contains("remove-student")&&t.target.closest(".flex.items-center.gap-2.mb-2").remove()}),b.addEventListener("submit",t=>{t.preventDefault();const n=new FormData(t.target),e=Object.fromEntries(n.entries()),l=i.get()||[],r=l.findIndex(s=>s.id===e.id),f=Array.from(document.querySelectorAll('#studentsContainer input[name="students[]"]')).map(s=>s.value.trim()).filter(s=>s!=="");if(r!==-1){const s=[...l];s[r]={...s[r],title:e.title,amount:e.amount,description:e.description,status:e.status,applyTo:e.applyTo,semester:e.semester||null,career:e.career||null,students:f},i.set(s),alert("Concepto actualizado con éxito.")}else{const s={id:crypto.randomUUID(),title:e.title,amount:e.amount,description:e.description,status:"Activo",applyTo:e.applyTo,semester:e.semester||null,career:e.career||null,students:f};i.set([...l,s]),alert("Concepto creado con éxito.")}window.location.href="/concepts"}),c&&c.addEventListener("click",t=>{const n=t.target.closest("button");if(n){const e=n.dataset.target;u.value=e,g(e)}})});
